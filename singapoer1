First code from Singapoer.
Final updated by Singapoer.
